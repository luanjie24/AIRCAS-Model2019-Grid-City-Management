# -
本项目用到时间序列分析与预测、深度学习、数据挖掘的相关知识

由于不知道数据是否可以公开，所以仓库设置成私密了

注意事项：
1.不要改动备份数据的内容，【code】文件夹中提供了测试数据，可以在【code】文件夹中添加测试数据
2.将生成的图表放入【图表】文件夹中对应的位置，方便写论文时使用
3.将值得说明的文字内容以及资料放入【论文初稿】文件夹的对应位置，方便写论文时使用

=====================================================================================================================================================================

2019.7.17

现在的任务：
1. 现有LSTM算法和ARMA算法精度计算、误差计算、出图完善 
2.实现刚刚的2-3个其他算法 
3.还要分析一下站点数据之间的相关性 
4.对LSTM设置不同 time lag(delay) 和每层神经元节点数产生的误差进行实验和比较 
5.选取效果最好的time lag和每层神经元节点数，然后跑筛选后的数据，五种类型分开跑，
	然后按照城市系统工程研究中心老师的要求，分析什么样子的数据预测效果好，这样子的数据对应于什么街道，什么案件 
6.依据上述各实验比对结果，以及最后的分析进行论文撰写。

=====================================================================================================================================================================



=====================================================================================================================================================================

2019.7.19

改进了ARMA，积存渣土的西长安街街道的数据跑不通
跑通的都放到了图标里了
还有待改进

下午ARMA已经完成

整体情况是
乱堆物料整体最准，非法小广告整体最不准 积存渣土的数据模型不接受
至于预测效果的准确程度和什么有关，还希望能进一步仔细观察对比图表数据
初步观察是和数据平稳度与数据的数量级有关
打算开始ARIMA，增强原有数据平稳度

=====================================================================================================================================================================

2019.7.22

完成SVR，预测效果依然不理想
差分法成功，数据平稳化成功
关于ARMA和ARIMA，有的站点跑不同已经排除数据不平稳的影响，推测是由于p，q定阶不准造成的，接下来会修改定阶的办法

Auto-Arima可以自动修改p和q，但预测出的数据仅仅是一个趋势。

样本数据没有特定的趋势或季节性，因此推测LSTM依然是最合适的办法

接下来会先尝试新的定阶的方法，然后便要开始着手调试LSTM了。


=====================================================================================================================================================================

2019.7.30

修改LSTM 最近还在了解深度学习算法以及Keras的应用，这块是难点
现在LSTM可以跑全部站点
接下来主要是准确度方面的研究
首先是要分站点归一化，这个还要和学长讨论一下
其次是控制变量实验，比如改变学习率，改变层数之类的，看哪个准确度最高。


=====================================================================================================================================================================

2019.8.1
相关性分析完成，各站点相关性不大，看来还是得分站点测试，根据这个改代码是最难的部分
等改完代码就可以测试了（如果能改完的话。。）
测试规划：
epoch=10,40,60,100分析结果
节点数=600，800，1000分析结果
delay=4,8,12分析结果
batch_size=12，24，48分析结果
学习率这个比较复杂，还得再想想

=====================================================================================================================================================================
2019.8.4
 
 改了好多东西。。基本上填了很多之前代码的坑
 

又做了很多实验，重新修正实验参数如下：
#epoch=10,40,80,100分析结果，没必要，最后趋于平稳就行了
LSTM层节点数=10，50，100，500分析结果
delay=4,8,10，12分析结果
batch_size=1，8，16，32分析结果
初始学习率=0.001，0.005，0.01分析结果
归一化尺度也有影响，但很难比较哪种尺度更准确

注意事项：
每一次的LSTM对比试验要将测试准确率和训练准确率分开总结，
并且每更改一个参数，要跑3次取最好结果
或者每次的loss控制在50以内，且mape趋于平稳且mape的值小于0.5 否则要重新跑

文件夹参数分配：

文件夹“参数1”参数：
  初始学习率=0.001，LSTM层节点数=50，delay=10，batch_size=16


文件夹“参数2”参数：
  初始学习率=0.001，LSTM层节点数=50，delay=10，batch_size=1

文件夹“参数3”参数：
  初始学习率=0.001，LSTM层节点数=50，delay=10，batch_size=8

文件夹“参数4”参数：
  初始学习率=0.001，LSTM层节点数=50，delay=10，batch_size=32


文件夹“参数5”参数：
  初始学习率=0.001，LSTM层节点数=10，delay=10，batch_size=16

文件夹“参数6”参数：
  初始学习率=0.001，LSTM层节点数=100，delay=10，batch_size=16

文件夹“参数7”参数：
  初始学习率=0.001，LSTM层节点数=500，delay=10，batch_size=16


文件夹“参数8”参数：
  初始学习率=0.001，LSTM层节点数=50，delay=4，batch_size=16

文件夹“参数9”参数：
  初始学习率=0.001，LSTM层节点数=50，delay=8，batch_size=16

文件夹“参数10”参数：
  初始学习率=0.001，LSTM层节点数=50，delay=12，batch_size=16


文件夹“参数11”参数：
  初始学习率=0.01，LSTM层节点数=50，delay=10，batch_size=16
文件夹“参数12”参数：
  初始学习率=0.005，LSTM层节点数=50，delay=10，batch_size=16

每个参数除了跑数据，还需要更新
	1. Project\图表\LSTM图表\分站点预测相应参数文件夹的内容
	2. Project\LSTM分站点输出预测数据文件相应参数文件夹的内容
	3. Project\LSTM图分析
	
#参数1已经完成，剩下的需要分工完成，三处更新可参考参数1文件夹

=====================================================================================================================================================================
2019.8.5
今天又进行了进一步沟通，更改了如下问题：
1. 将所有站点的命名改为站点1、站点2、站点3....的编号形式
2. 由于“积存渣土”一类的预测相比于其他类更加准确，因此接下来将选取“无照经营”文件进行对比实验
3. 采用单站点LSTM的方式进行预测，其他模型方式作为对比，误差统一使用MAPE来计算

分工测试步骤：
第一步：打开Project\code\LSTM(分站点预测).py，更改相应参数依次运行各站点。

第二步：观察每次运行完成的站点结果的MAPE，尽量保证最终的测试MAPE小于0.5，且MAPE的值趋于平稳，否则重新运行程序。
		如果实验多次MAPE站点的结果仍无法小于0.5，则将该站点的名称记录在"Project\LSTM分站点结果分析"相应的位置
		如果该站点的MAPE小于0.2，则将该站点的名称记录在"Project\LSTM分站点结果分析"相应的位置
		#以上两个“如果”的记录方式如有疑问可参考"Project\LSTM分站点结果分析"的"参数1-分站点结果分析.txt"文件的内容
		#程序生成的图片不用手动保存，代码已经自动保存到了当前目录下，但每次新的都会覆盖旧的

第三步：Project\code目录下将所有得到的数据图片复制到Project\图表\LSTM图表\分站点预测\相应参数\积存渣土文件夹下


第四步：Project\code目录下将所有得到的“预测输出”复制到Project\LSTM分站点输出预测数据文件\相应参数\积存渣土文件夹下

第五步：打开步骤二的【站点结果分析.txt】文件，把里面“准”与“不准”相应的图表放到Project\LSTM分站点结果分析\相应参数极端数据图表
		例如，站点4的MAPE不准，则将“无照经营-站点4-当前打乱的原始数据.png”这一图放到Project\LSTM分站点结果分析\相应参数极端数据图表，
		并更改文件名字为“【不准】无照经营-站点4-当前打乱的原始数据.png”
		#如果还不明白可参考参数1

第六步：对比准和不准的原始数据特点（数量级、趋势等），如果发现准的数据与不准的数据有明显的数据上的区别，请通知我

第七步：返回第一步，更改参数继续实验

接下来便可以按照昨天提到的参数来进行试验了。
